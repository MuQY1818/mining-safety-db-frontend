# 矿区安全数据库前端 - 安全头配置文件
# 统一管理HTTP安全响应头

# 防止点击劫持攻击
add_header X-Frame-Options "SAMEORIGIN" always;

# 防止MIME类型混淆攻击
add_header X-Content-Type-Options "nosniff" always;

# XSS防护
add_header X-XSS-Protection "1; mode=block" always;

# 推荐人策略 - 保护用户隐私
add_header Referrer-Policy "no-referrer-when-downgrade" always;

# 内容安全策略 - 防止XSS和数据注入攻击
add_header Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; img-src 'self' data: blob: https:; font-src 'self' https://fonts.gstatic.com; connect-src 'self' https://mining-backend.ziven.site https://api.siliconflow.cn wss: ws:; media-src 'self'; object-src 'none'; child-src 'self'; form-action 'self'; frame-ancestors 'self';" always;

# 权限策略 - 限制浏览器API访问
add_header Permissions-Policy "geolocation=(), microphone=(), camera=(), payment=(), usb=(), magnetometer=(), accelerometer=(), gyroscope=(), battery=()" always;

# 跨源嵌入器策略 - 增强安全性
add_header Cross-Origin-Embedder-Policy "unsafe-none" always;

# 跨源打开器策略 - 防止跨站攻击
add_header Cross-Origin-Opener-Policy "same-origin-allow-popups" always;

# 跨源资源策略 - 控制资源访问
add_header Cross-Origin-Resource-Policy "cross-origin" always;

# 如果启用HTTPS，取消下面注释
# HSTS - 强制HTTPS
# add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always;

# 期望证书透明度
# add_header Expect-CT "enforce, max-age=30, report-uri=\"https://example.com/ct-report\"" always;